<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.111.2"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Automatically generate code and documentation using OpenAI CODEX | Shashank Prasanna</title><meta name=description content="Use OpenAI CODEX to automatically edit existing code to add documentation, only using only natural language instructions"><meta property="og:title" content="Automatically generate code and documentation using OpenAI CODEX"><meta property="og:description" content="Use OpenAI CODEX to automatically edit existing code to add documentation, only using only natural language instructions"><meta property="og:type" content="article"><meta property="og:url" content="https://shashankprasanna.com/automatically-generate-code-and-documentation-using-openai-codex/"><meta property="og:image" content="https://shashankprasanna.com/automatically-generate-code-and-documentation-using-openai-codex/screenshot8-featured.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-08-01T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-01T00:00:00+00:00"><meta property="og:site_name" content="Shashank Prasanna"><meta itemprop=name content="Automatically generate code and documentation using OpenAI CODEX"><meta itemprop=description content="Use OpenAI CODEX to automatically edit existing code to add documentation, only using only natural language instructions"><meta itemprop=datePublished content="2022-08-01T00:00:00+00:00"><meta itemprop=dateModified content="2022-08-01T00:00:00+00:00"><meta itemprop=wordCount content="1547"><meta itemprop=image content="https://shashankprasanna.com/automatically-generate-code-and-documentation-using-openai-codex/screenshot8-featured.png"><meta itemprop=keywords content="openai,codex,AI,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shashankprasanna.com/automatically-generate-code-and-documentation-using-openai-codex/screenshot8-featured.png"><meta name=twitter:title content="Automatically generate code and documentation using OpenAI CODEX"><meta name=twitter:description content="Use OpenAI CODEX to automatically edit existing code to add documentation, only using only natural language instructions"><link rel=preload href=/scss/main.min.d52090214b935da5063a78e99e2d9aae8ec8f1ac412ba25bd23c200ed237fee8.css as=style><link href=/scss/main.min.d52090214b935da5063a78e99e2d9aae8ec8f1ac412ba25bd23c200ed237fee8.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-20Q10LSLZ7"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-20Q10LSLZ7")}</script></head><body class="td-page td-blog"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Shashank Prasanna</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/><span class=active>Resources</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/blog/><span class=active>Personal Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://medium.com/@shashankprasanna target=_blank><i class='fa-brands fa-medium'></i><span>Medium Blog</span><sup><i class='ps-1 fa-solid fa-up-right-from-square fa-xs' aria-hidden=true></i></sup></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.67dcb9ac36109f3985fa16ad7ddf536d.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.67dcb9ac36109f3985fa16ad7ddf536d.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-blog-li><a href=/blog/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-blog><span>Personal Blog</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-automatically-generate-code-and-documentation-using-openai-codex-li><a href=/automatically-generate-code-and-documentation-using-openai-codex/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-automatically-generate-code-and-documentation-using-openai-codex><span class=td-sidebar-nav-active-item>Automatically generate code and documentation using OpenAI CODEX</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><div class=box><img style=vertical-align:middle src=https://shashankprasanna.com/featured-background.png alt="shashank prasanna" width=200><br><div class=row><div class=column><a href=https://twitter.com/shshnkp target=_blank><font color=black size=6>&nbsp;&nbsp;<i class="fa fab fa-twitter"></i></font></a></div><div class=column>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class=column><a href=https://www.youtube.com/@shashank.prasanna target=_blank><font color=black size=6><i class="fa fab fa-youtube"></i></font></a></div><div class=column>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class=column><a href=https://medium.com/@shashankprasanna target=_blank><font color=black size=6><i class="fa fab fa-medium"></i></font></a></div><div class=column>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class=column><a href=https://www.linkedin.com/in/shashankprasanna/ target=_blank><font color=black size=6><i class="fa fab fa-linkedin"></i></font></a></div></div><font color=black size=2>&nbsp;&nbsp;Speaker request? Let's connect!</font></div><hr><a href=https://github.com/shashankprasanna/shashankprasanna.com/tree/main/content/en/blog/Automatically%20generate%20code%20and%20documentation%20using%20OpenAI%20CODEX/index.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/shashankprasanna/shashankprasanna.com/edit/main/content/en/blog/Automatically%20generate%20code%20and%20documentation%20using%20OpenAI%20CODEX/index.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/shashankprasanna/shashankprasanna.com/new/main/content/en/blog/Automatically%20generate%20code%20and%20documentation%20using%20OpenAI%20CODEX/index.md?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/shashankprasanna/shashankprasanna.com/issues/new?title=Automatically%20generate%20code%20and%20documentation%20using%20OpenAI%20CODEX" class=td-page-meta--issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/shashankprasanna/shashankprasanna.com/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#using-openai-codex-edit-feature-to-generate-fully-documented-code-to-train-a-classifier-on-a-tabular-dataset>Using OpenAI Codex edit feature to generate fully documented code to train a classifier on a tabular dataset</a><ul><li><a href=#step-1-setting-up-openai-python-package>Step 1: Setting up OpenAI Python package</a></li><li><a href=#step-2-generate-python-code-to-load-an-analyze-the-dataset>Step 2: Generate python code to load an analyze the dataset</a></li><li><a href=#step-3-generate-a-python-program-to-classify-the-dataset>Step 3: Generate a Python program to classify the dataset</a></li><li><a href=#step-4-fixing-errors-in-the-generated-code-by-updating-the-instructions>Step 4: Fixing errors in the generated code by updating the instructions</a></li><li><a href=#step-5-generate-detailed-documentation>Step 5: Generate detailed documentation</a></li></ul></li><li><a href=#now-its-your-turn>Now it&rsquo;s your turn!</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main><a class=td-rss-button title=RSS href=https://shashankprasanna.com/blog/index.xml target=_blank rel=noopener><i class="fa-solid fa-rss" aria-hidden=true></i></a><div class=td-content><h1>Automatically generate code and documentation using OpenAI CODEX</h1><div class=lead>Use OpenAI CODEX to automatically edit existing code to add documentation, only using only natural language instructions</div><div class="td-byline mb-4">By <b>Shashank Prasanna</b> |
<time datetime=2022-08-01 class=text-muted>Monday, August 01, 2022</time></div><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://shashankprasanna.com/tags/openai/ data-taxonomy-term=openai><span class=taxonomy-label>openai</span></a></li><li><a class=taxonomy-term href=https://shashankprasanna.com/tags/codex/ data-taxonomy-term=codex><span class=taxonomy-label>codex</span></a></li><li><a class=taxonomy-term href=https://shashankprasanna.com/tags/ai/ data-taxonomy-term=ai><span class=taxonomy-label>AI</span></a></li></ul></div></header><p>We&rsquo;ve all dealt with the frustration of poor or incomplete documentation in software projects. In their <a href=https://octoverse.github.com/creating-documentation/>2021 state of the Octoverse survey</a>, GitHub found that easy to use documentation, boosted developer productivity by 50% and improved contribution quality, yet it continues to be an under-invested area across open-source projects.</p><p>Using OpenAI Codex you can use to automatically edit existing code to add documentation using only natural language instructions. This new feature will let you spend more time developing new features and reviewing generated documentation instead of writing documentation from scratch. In addition to generating documentation, Codex&rsquo;s edit feature can refactor code, update logic, translate between programming languages and change coding styles.</p><p>In this blog post, we&rsquo;ll take a look at how Codex edit feature works through a code example. One of my favorite areas of machine learning (ML) research is automated machine learning (AutoML) or low-code ML. I&rsquo;ll use Codex to implement a simple data science workflow only using natural language instructions and without writing any ML code. We&rsquo;ll perform the following steps only using Codex&rsquo;s Edit API and discuss its features as we implement the code example:</p><ol><li><p>Generate python code to load a dataset and visualize it</p></li><li><p>Generate python code to train a machine learning classifier on the dataset</p></li><li><p>Edit generated code to customize it for the specific problem dataset</p></li><li><p>Edit updated code to add detailed documentation</p></li></ol><p>Sounds exciting? Let&rsquo;s get started!</p><h2 id=using-openai-codex-edit-feature-to-generate-fully-documented-code-to-train-a-classifier-on-a-tabular-dataset>Using OpenAI Codex edit feature to generate fully documented code to train a classifier on a tabular dataset</h2><p>Let&rsquo;s use OpenAI Codex to solve the <a href=https://www.kaggle.com/c/titanic/data>Titanic - Machine Learning from Disaster</a> Kaggle competition. The titanic dataset consists of passenger information like name, age, gender, etc. and if they survived the disaster or not. We&rsquo;ll use natural language prompts to iteratively build code and documentation. To download the dataset, you&rsquo;ll need to create a free Kaggle account and download it either via the web page or by following the instructions on the <a href=https://github.com/Kaggle/kaggle-api>Kaggle API GitHub page</a>.</p><p>Next, you&rsquo;ll need an Open AI account. If you&rsquo;re new to OpenAI, head over to <a href=https://openai.com/api/login/>https://openai.com/api/login/</a> and create your free trial account. This will give you access to $18 in free credit that you can use for upto 3 months.</p><p>After you&rsquo;ve created your account, you&rsquo;ll have access to your unique API keys that you can use to invoke the OpenAI API using the official <a href=https://beta.openai.com/docs/libraries/python-bindings>Python</a>, Node.js or any of the <a href=https://beta.openai.com/docs/libraries/community-libraries>community supported libraries</a>. Since our example generates Python code, we&rsquo;ll use the Python bindings.</p><h3 id=step-1-setting-up-openai-python-package>Step 1: Setting up OpenAI Python package</h3><p>Open your favorite IDE to get started, I prefer Jupyter Lab as it&rsquo;s the most popular IDE used by data scientists. Import openai Python package and specify your organization and API keys. You can find these on your Open AI account.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> openai
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>organization <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;org-XXXXXXXXXXXXXXX&#34;</span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sk-XXXXXXXXXXXXXXXX&#34;</span>
</span></span></code></pre></div><h3 id=step-2-generate-python-code-to-load-an-analyze-the-dataset>Step 2: Generate python code to load an analyze the dataset</h3><p>We can use the Codex edit feature to edit existing code or generate new code. Let&rsquo;s start by generating some fresh code to load our Titanic CSV dataset and analyze it.</p><p>Here&rsquo;s what the arguments to the create() function mean:</p><ul><li><p><strong>Input</strong>: Provide a prompt as a starting point. We leave it empty since we&rsquo;re going to generate new code and not edit existing code.</p></li><li><p><strong>Instructions</strong>: Provide instructions to Codex on what code to generate. Here we describe that we want to generate code to load and analyze our CSV dataset.</p></li><li><p><strong>Engine</strong>: Provide the engine for Codex edit feature, the latest name and version is <code>Code-davinci-edit-001</code></p></li><li><p><strong>Temperature</strong> and <strong>top_p</strong>: used to control how deterministic the model is in generating a response. I choose a lower value for top_p (=0.2) to get a consistent response.</p></li></ul><p>You can find more information about the API in the <a href=https://beta.openai.com/docs/api-reference/edits/create>Edits documentation</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> IPython.display <span style=color:#f92672>import</span> display
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input_prompt <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>instruction <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Write python function to load a CSV file called titanic.csv into a dataframe and use display function&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> openai<span style=color:#f92672>.</span>Edit<span style=color:#f92672>.</span>create(input<span style=color:#f92672>=</span>input_prompt, 
</span></span><span style=display:flex><span>                              instruction<span style=color:#f92672>=</span>instruction, 
</span></span><span style=display:flex><span>                              engine<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;code-davinci-edit-001&#34;</span>,
</span></span><span style=display:flex><span>                              temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                              top_p<span style=color:#f92672>=</span><span style=color:#ae81ff>0.2</span>)
</span></span></code></pre></div><p><strong>Output:</strong></p><p>When you run the code, you should see an output that looks like the screenshot below. From the output we can see that the dataset has both numeric and categorical variables. This information will come in handy later when we ask Codex to edit our function. For now, let&rsquo;s continue to build on this program to classify the dataset.</p><p><img src=screenshot1.png alt></p><h3 id=step-3-generate-a-python-program-to-classify-the-dataset>Step 3: Generate a Python program to classify the dataset</h3><p>In this step, rather than leave the input prompt empty, let&rsquo;s provide the function signature we expect so Codex can fill out the rest of the program. Under instructions we provide:</p><ul><li>&ldquo;Write python function to load a CSV file and perform binary XGBoost classification on a target column:</li></ul><p>Extending our previous example, we&rsquo;ll ask Codex to generate a program to use XGBoost to classify our dataset based on a specified target variable. If you&rsquo;re new to machine learning, XGBoost is a fantastic works-out-of-the-box classifier for tabular datasets that often requires little to no fine tuning to get acceptable results.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>input_prompt <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>def csv_classification(csv_file, target_column):
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>instruction <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Write python function to load a CSV file and perform binary XGBoost classification on a target column&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> openai<span style=color:#f92672>.</span>Edit<span style=color:#f92672>.</span>create(input<span style=color:#f92672>=</span>input_prompt, 
</span></span><span style=display:flex><span>                              instruction<span style=color:#f92672>=</span>instruction, 
</span></span><span style=display:flex><span>                              engine<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;code-davinci-edit-001&#34;</span>,
</span></span><span style=display:flex><span>                              temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                              top_p<span style=color:#f92672>=</span><span style=color:#ae81ff>0.2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>generated_code <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#34;choices&#34;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#34;text&#34;</span>]
</span></span><span style=display:flex><span>print(generated_code)
</span></span></code></pre></div><p><strong>Output:</strong></p><p>Codex generates the following code to classify our dataset using XGBoost. If you&rsquo;re new to machine learning, let&rsquo;s just take a moment to appreciate how much time we saved by having Codex generate this vs. writing this from scratch. We still need to test if this code works, so let&rsquo;s go ahead and do that in the next step.</p><p><img src=screenshot2.png alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>exec(generated_code)
</span></span><span style=display:flex><span>csv_classification(<span style=color:#e6db74>&#39;titanic.csv&#39;</span>,<span style=color:#e6db74>&#39;Survived&#39;</span>)
</span></span></code></pre></div><p><strong>Output:</strong></p><p>Oh no! the generated code throws an error! Not what we want to see, but let&rsquo;s take a closer look at the error message. The error message says:</p><ol><li><p>We have categorical variables that need to be specified as categorical variables. If we go back to the output of Step 1, we can verify from that the Name, Sex, Ticket, Cabin and Embarked are indeed categorical.</p></li><li><p>Since we have categorical variables, we need to instruct XGBoost to enable categorical support using `enable_categorical` argument.</p></li></ol><p>To remedy this, let&rsquo;s make Codex do all the hard work by simply copying the error message and including it in the instructions of the next step.</p><p><img src=screenshot3.png alt></p><h3 id=step-4-fixing-errors-in-the-generated-code-by-updating-the-instructions>Step 4: Fixing errors in the generated code by updating the instructions</h3><p>In this step, we start with the generated code from Step 3, and provide instructions to make changes specified in the error message. We provide the following instructions:</p><ul><li>&ldquo;Update code to set dataframe columns Name, Sex, Ticket, Cabin, Embarked to categorical and set DMatrix parameter 'enable_categorical' to 'True'&rdquo;</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>input_prompt <span style=color:#f92672>=</span> generated_code
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>instruction <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Update code to set dataframe columns Name, Sex, Ticket, Cabin, Embarked to categorical and set DMatrix parameter &#39;enable_categorical&#39; to &#39;True&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> openai<span style=color:#f92672>.</span>Edit<span style=color:#f92672>.</span>create(input<span style=color:#f92672>=</span>input_prompt, 
</span></span><span style=display:flex><span>                              instruction<span style=color:#f92672>=</span>instruction, 
</span></span><span style=display:flex><span>                              engine<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;code-davinci-edit-001&#34;</span>,
</span></span><span style=display:flex><span>                              temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                              top_p<span style=color:#f92672>=</span><span style=color:#ae81ff>0.2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>generated_code <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#34;choices&#34;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#34;text&#34;</span>]
</span></span><span style=display:flex><span>print(generated_code)
</span></span></code></pre></div><p><strong>Output:</strong></p><p>This generates updated code that addresses the categorical variable errors by converting the specified column into categorical and by setting enable_categorical to True when creating the XGBoost&rsquo;s native DMatrix data structure. Again let&rsquo;s take a moment to appreciate how little we had to do to generate code for a generic tabular data classifier using XGBoost.</p><p><img src=screenshot4.png alt></p><p>Let&rsquo;s go ahead and execute this code to train our classifier:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>exec(generated_code)
</span></span><span style=display:flex><span>csv_classification(<span style=color:#e6db74>&#39;titanic.csv&#39;</span>,<span style=color:#e6db74>&#39;Survived&#39;</span>)
</span></span></code></pre></div><p><strong>Output:</strong></p><p>Sure enough, our code now runs without any issues and trains the classifier to 83% accuracy on the test set. Note that this is a very simple dataset, but the generated code can now be used for a number of tabular classification problems. Need to modify the code to change features? Just repeat the instructions in this step to specify what needs to be updated.</p><p><img src=screenshot5.png alt></p><h3 id=step-5-generate-detailed-documentation>Step 5: Generate detailed documentation</h3><p>Finally, let&rsquo;s use the generated code and add detailed documentation to it using Codex. To do that we provide natural language instructions on how and where to add comments:</p><ul><li>&ldquo;Add a detailed paragraph at the top of the code describing what the code is doing, and add detailed comments explaining every line of code&rdquo;</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>instruction <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Add a detailed paragraph at the top of the code describing what the code is doing, and add detailed comments explaining every line of code
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> openai<span style=color:#f92672>.</span>Edit<span style=color:#f92672>.</span>create(input<span style=color:#f92672>=</span>generated_code, 
</span></span><span style=display:flex><span>                              instruction<span style=color:#f92672>=</span>instruction, 
</span></span><span style=display:flex><span>                              engine<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;code-davinci-edit-001&#34;</span>,
</span></span><span style=display:flex><span>                              temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                              top_p<span style=color:#f92672>=</span><span style=color:#ae81ff>0.2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>documented_code <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#34;choices&#34;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#34;text&#34;</span>]
</span></span><span style=display:flex><span>print(documented_code)
</span></span></code></pre></div><p><strong>Output:</strong></p><p>Here you can see the detailed description of the full program, you can also see that the additional comments were automatically added under the function definition describing each line of code.</p><p><img src=screenshot6.png alt></p><p>If you&rsquo;re new to XGBoost, you can also use the generated documentation to learn about what each of the hyperparameters mean! Now you know that eta is actually the learning rate, and max_depth is the maximum depth of each of the 20 trees XGBoost uses. How cool is that?</p><p><img src=screenshot7.png alt></p><p>We now have a fully functional and documented code that you can use to submit your results to the Titanic Kaggle competition!</p><h2 id=now-its-your-turn>Now it&rsquo;s your turn!</h2><p>If this piqued your interest head on over to <a href=https://openai.com/api/login/>https://openai.com/api/login/</a> and create your free trial account. I&rsquo;m making all the code used in this blog post is available as a Jupyter notebook on GitHub so you can run the entire example with a single click</p><p>Now it&rsquo;s your turn! How will you use Codex&rsquo;s new edit feature? Let me know by reaching out to me at <a href=https://twitter.com/shshnkp>@shshnkp</a>
<img src=screenshot8-featured.png alt></p><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a class="btn btn-primary disabled"><span class=mr-1>←</span>Previous</a></li><li><a class="btn btn-primary disabled">Next<span class=ml-1>→</span></a></li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/shshnkp aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=LinkedIn aria-label=LinkedIn><a class=text-white target=_blank rel=noopener href=https://www.linkedin.com/in/shashankprasanna/ aria-label=LinkedIn><i class="fab fa-linkedin"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/shashankprasanna/ aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=YouTube aria-label=YouTube><a class=text-white target=_blank rel=noopener href=https://www.youtube.com/@shashank.prasanna aria-label=YouTube><i class="fab fa-youtube"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Medium aria-label=Medium><a class=text-white target=_blank rel=noopener href=https://medium.com/@shashankprasanna aria-label=Medium><i class="fab fa-medium"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Shashank Prasanna All Rights Reserved</small></div></div></div></footer></div><script src=/js/main.min.2aff983e9d0d8ecff9ed53e14b657216e2d8d2aff059bf4a5651283020995f1b.js integrity="sha256-Kv+YPp0Njs/57VPhS2VyFuLY0q/wWb9KVlEoMCCZXxs=" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script></body></html>